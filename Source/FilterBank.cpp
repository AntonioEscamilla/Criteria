/*
  ==============================================================================

    FilterBank.cpp
    Created: 12 Sep 2015 2:56:38pm
    Author:  Tony Ducks

  ==============================================================================
*/

#include "FilterBank.h"

const double SOS844[45][6]={{1,	0,	-1,	1,	-1.9986674001300200,	0.9987067107240430},
    {1,	0,	-1,	1,	-1.9993219285793400,	0.9993324001803750},
    {1,	0,	-1,	1,	-1.9968642029235300,	0.9968952953992390},
    {1,	0,	-1,	1,	-1.9979619096058700,	0.9979751280514260},
    {1, 0,	-1,	1,	-1.9968102566913300,	0.9968305235204460},
    {1,	0,	-1,	1,	-1.9972647969383400,	0.9974211952958850},
    {1,	0,	-1,	1,	-1.9986267120916900,	0.9986683864260230},
    {1,	0,	-1,	1,	-1.9936912092924400,	0.9938148008240180},
    {1,	0,	-1,	1,	-1.9959112755426700,	0.9959638459668070},
    {1,	0,	-1,	1,	-1.9936053694165500,	0.9936859265275660},
    {1,	0,	-1,	1,	-1.9942396084422900,	0.9948614221893250},
    {1,	0,	-1,	1,	-1.9971789902885700,	0.9973447894610030},
    {1,	0,	-1,	1,	-1.9872065087455900,	0.9876970173803960},
    {1,	0,	-1,	1,	-1.9917539555128000,	0.9919628230928220},
    {1,	0,	-1,	1,	-1.9871214578803300,	0.9874411564292190},
    {1,	0,	-1,	1,	-1.9873060783205600,	0.9897748759239710},
    {1,	0,	-1,	1,	-1.9940495811086300,	0.9947087437792980},
    {1, 0,	-1,	1,	-1.9736624735646000,	0.9756031706879550},
    {1,	0,	-1,	1,	-1.9831983148037600,	0.9840264883100670},
    {1, 0,	-1,	1,	-1.9738317878078300,	0.9750965743148440},
    {1,	0,	-1,	1,	-1.9699400647060300,	0.9797130406550290},
    {1,	0,	-1,	1,	-1.9868500932635800,	0.9894669468035570},
    {1,	0,	-1,	1,	-1.9442852735674100,	0.9519160799246230},
    {1,	0,	-1,	1,	-1.9651002830980000,	0.9683707759781090},
    {1, 0,	-1,	1,	-1.9459388548669400,	0.9509116078310910},
    {1,	0,	-1,	1,	-1.9215889051733900,	0.9600176775957080},
    {1,	0,	-1,	1,	-1.9687104454375000,	0.9790673229838810},
    {1,	0,	-1,	1,	-1.8767524878033300,	0.9063819267397120},
    {1,	0,	-1,	1,	-1.9249889165051300,	0.9377989523000280},
    {1,	0,	-1,	1,	-1.8850221741768000,	0.9043341189907490},
    {1,	0,	-1,	1,	-1.7738290952961900,	0.9224765868048390},
    {1,	0,	-1,	1,	-1.9177608282681900,	0.9584599557015760},
    {1,	0,	-1,	1,	-1.8297562948879300,	0.8790883536506750},
    {1,	0,	-1,	1,	-1.7099826443848800,	0.8221089883203640},
    {1,	0,	-1,	1,	-1.7441939209490700,	0.8173794203212700},
    {1,	0,	-1,	1,	-1.3060708033356100,	0.8562465353973760},
    {1,	0,	-1,	1,	-1.7601658256595300,	0.9171850371775290},
    {1,	0,	-1,	1,	-1.5855292867278100,	0.7685732455283030},
    {1,	0,	-1,	1,	-1.2759713723684400,	0.6780899580714670},
    {1,	0,	-1,	1,	-1.3992172191340500,	0.6631638238525220},
    {1,	0,	-1,	1,	-1.2555875324992800,	0.8278195395150760},
    {1,	0,	-1,	1,	 0.0190080302373439,    0.7705137664000880},
    {1,	0,	-1,	1,	-0.9416208309196550,	0.5579205957689550},
    {1,	0,	-1,	1,	-0.1929925024449150,	0.4780497896983700},
    {1,	0,	-1,	1,	-0.5534453212607850,	0.4071975477023250}};
const double G844[45]={
    0.001586473667708590,
    0.001586473667708590,
    0.001585217330670710,
    0.001585217330670710,
    0.001584738239776890,
    0.003163924414020910,
    0.003163924414020910,
    0.003158935944076120,
    0.003158935944076120,
    0.003157036736217180,
    0.006306673319933880,
    0.006306673319933880,
    0.006286918578253200,
    0.006286918578253200,
    0.006279421785390550,
    0.012558880230601900,
    0.012558880230601900,
    0.012481058540429600,
    0.012481058540429600,
    0.012451712842578000,
    0.024960601702791700,
    0.024960601702791700,
    0.024657199404280600,
    0.024657199404280600,
    0.024544196084454500,
    0.049413287011114700,
    0.049413287011114700,
    0.048254514842771000,
    0.048254514842771000,
    0.047832940504625500,
    0.097043404085042000,
    0.097043404085042000,
    0.092792554708133600,
    0.092792554708133600,
    0.091310289839364800,
    0.187542527250336000,
    0.187542527250336000,
    0.173112100564856000,
    0.173112100564856000,
    0.168418088073739000,
    0.351319871968514000,
    0.351319871968514000,
    0.308962230685037000,
    0.308962230685037000,
    0.296401226148837000};
const double SOS344[145][6]={{1,	0,	-1,	1,	-1.9997010107675900,	0.9997169554943040},
    {1,	0,	-1,	1,	-1.9997623704754600,	0.9997726560787310},
    {1,	0,	-1,	1,	-1.9992719968394700,	0.9992866682314780},
    {1,	0,	-1,	1,	-1.9993662196384400,	0.9993773932338550},
    {1,	0,	-1,	1,	-1.9991616056566000,	0.9991744083497390},
    {1,	0,	-1,	1,	-1.9996184656750100,	0.9996437347069340},
    {1,	0,	-1,	1,	-1.9996975315126400,	0.9997138330491110},
    {1,	0,	-1,	1,	-1.9990789090516300,	0.9991021579767000},
    {1,	0,	-1,	1,	-1.9991986604135200,	0.9992163693306840},
    {1,	0,	-1,	1,	-1.9989406050072000,	0.9989608937270930},
    {1,	0,	-1,	1,	-1.9995114267638000,	0.9995514732307660},
    {1,	0,	-1,	1,	-1.9996138970418800,	0.9996397319144690},
    {1,	0,	-1,	1,	-1.9988328918983600,	0.9988697345650000},
    {1,	0,	-1,	1,	-1.9989854419953700,	0.9990135051130780},
    {1,	0,	-1,	1,	-1.9986597795511900,	0.9986919301952780},
    {1,	0,	-1,	1,	-1.9993718905355000,	0.9994353564684010},
    {1,	0,	-1,	1,	-1.9995055189976600,	0.9995464630222820},
    {1,	0,	-1,	1,	-1.9985188685211900,	0.9985772517808360},
    {1,	0,	-1,	1,	-1.9987137417036000,	0.9987582135711030},
    {1,	0,	-1,	1,	-1.9983025334921900,	0.9983534804915470},
    {1,	0,	-1,	1,	-1.9991886141006000,	0.9992891948399520},
    {1,	0,	-1,	1,	-1.9993641652777400,	0.9994290539726820},
    {1,	0,	-1,	1,	-1.9981166470634400,	0.9982091623951400},
    {1,	0,	-1,	1,	-1.9983664339487100,	0.9984369065493780},
    {1,	0,	-1,	1,	-1.9978468287505500,	0.9979275580331350},
    {1,	0,	-1,	1,	-1.9989459060802600,	0.9991052982081350},
    {1,	0,	-1,	1,	-1.9991784800061200,	0.9992813154108680},
    {1,	0,	-1,	1,	-1.9975995619613800,	0.9977461532188820},
    {1,	0,	-1,	1,	-1.9979210278739600,	0.9980326975217060},
    {1,	0,	-1,	1,	-1.9972639091177900,	0.9973918217894190},
    {1,	0,	-1,	1,	-1.9986211333124700,	0.9988737227197710},
    {1,	0,	-1,	1,	-1.9989323160976400,	0.9990952810302970},
    {1,	0,	-1,	1,	-1.9969310270537900,	0.9971632893435610},
    {1,	0,	-1,	1,	-1.9973469140014400,	0.9975238507080240},
    {1,	0,	-1,	1,	-1.9965148206573600,	0.9967174780110890},
    {1,	0,	-1,	1,	-1.9981820622688300,	0.9985823265741560},
    {1,	0,	-1,	1,	-1.9986029116079600,	0.9988611625481610},
    {1,	0,	-1,	1,	-1.9960621698066000,	0.9964301421547210},
    {1,	0,	-1,	1,	-1.9966033898750500,	0.9968837245690850},
    {1,	0,	-1,	1,	-1.9955482826221300,	0.9958693343393860},
    {1,	0,	-1,	1,	-1.9975813662148000,	0.9982156119297310},
    {1,	0,	-1,	1,	-1.9981572665324200,	0.9985665014887420},
    {1,	0,	-1,	1,	-1.9949250321959500,	0.9955079483304570},
    {1,	0,	-1,	1,	-1.9956343207015000,	0.9960784362157100},
    {1,	0,	-1,	1,	-1.9942940651376400,	0.9948026177849450},
    {1,	0,	-1,	1,	-1.9967491838927100,	0.9977541308113640},
    {1,	0,	-1,	1,	-1.9975471887776500,	0.9981956474203240},
    {1,	0,	-1,	1,	-1.9934248604074200,	0.9943481561463310},
    {1,	0,	-1,	1,	-1.9943620061290100,	0.9950655080168920},
    {1,	0,	-1,	1,	-1.9926558268497800,	0.9934612657424470},
    {1,	0,	-1,	1,	-1.9955813004994400,	0.9971734916966820},
    {1,	0,	-1,	1,	-1.9967014848971800,	0.9977289484805660},
    {1,	0,	-1,	1,	-1.9914278286302100,	0.9928900184211340},
    {1,	0,	-1,	1,	-1.9926775104887000,	0.9937917352405640},
    {1,	0,	-1,	1,	-1.9904997555834500,	0.9917751611726690},
    {1,	0,	-1,	1,	-1.9939662403786800,	0.9964791465182230},
    {1,	0,	-1,	1,	-1.9955377839237500,	0.9971655156394740},
    {1,	0,	-1,	1,	-1.9888373692517900,	0.9911454781103080},
    {1,	0,	-1,	1,	-1.9904953466872000,	0.9922584552572710},
    {1,	0,	-1,	1,	-1.9877374949103800,	0.9897528170311890},
    {1,	0,	-1,	1,	-1.9914925172316900,	0.9954874023970870},
    {1,	0,	-1,	1,	-1.9938106275408100,	0.9963797349252460},
    {1,	0,	-1,	1,	-1.9850043800837700,	0.9886659713947480},
    {1,	0,	-1,	1,	-1.9873265566297200,	0.9901112299642770},
    {1,	0,	-1,	1,	-1.9837102768346900,	0.9868994760737910},
    {1,	0,	-1,	1,	-1.9880419442636400,	0.9943691825356730},
    {1,	0,	-1,	1,	-1.9913884519396300,	0.9954732119271700},
    {1,	0,	-1,	1,	-1.9800663969918700,	0.9858649254401820},
    {1,	0,	-1,	1,	-1.9832289811379100,	0.9876499506151050},
    {1,	0,	-1,	1,	-1.9786006913600200,	0.9836559611724060},
    {1,	0,	-1,	1,	-1.9828995304116300,	0.9929171574223070},
    {1,	0,	-1,	1,	-1.9878350263017800,	0.9943038370243010},
    {1,	0,	-1,	1,	-1.9730676765504900,	0.9822384274320650},
    {1,	0,	-1,	1,	-1.9774816910833900,	0.9844757866457190},
    {1,	0,	-1,	1,	-1.9714737890515800,	0.9794670464909360},
    {1,	0,	-1,	1,	-1.9752385479646200,	0.9910931381820460},
    {1,	0,	-1,	1,	-1.9825915414163000,	0.9928331472323330},
    {1,	0,	-1,	1,	-1.9631981163317700,	0.9776931288332910},
    {1,	0,	-1,	1,	-1.9694342798765800,	0.9804932708553980},
    {1,	0,	-1,	1,	-1.9615884909491600,	0.9742186572584690},
    {1,	0,	-1,	1,	-1.9637237357185900,	0.9888032338518110},
    {1,	0,	-1,	1,	-1.9747749196527500,	0.9909836071826810},
    {1,	0,	-1,	1,	-1.9491115191882300,	0.9720026231603830},
    {1,	0,	-1,	1,	-1.9580261153040500,	0.9755000364492340},
    {1,	0,	-1,	1,	-1.9477111123233100,	0.9676501701736070},
    {1,	0,	-1,	1,	-1.9462888242218100,	0.9859311530921740},
    {1,	0,	-1,	1,	-1.9630190434210300,	0.9886577591864530},
    {1,	0,	-1,	1,	-1.9287796741325400,	0.9648892229329120},
    {1,	0,	-1,	1,	-1.9416615483495600,	0.9692451272330120},
    {1,	0,	-1,	1,	-1.9280015514064100,	0.9594415230027180},
    {1,	0,	-1,	1,	-1.9197409093240500,	0.9823340698826680},
    {1,	0,	-1,	1,	-1.9452090117058900,	0.9857330833813320},
    {1,	0,	-1,	1,	-1.8991432771809100,	0.9560157251418030},
    {1,	0,	-1,	1,	-1.9179327838299100,	0.9614185560000670},
    {1,	0,	-1,	1,	-1.8997077087715500,	0.9492027462027150},
    {1,	0,	-1,	1,	-1.8791635125657900,	0.9778372577136840},
    {1,	0,	-1,	1,	-1.9180744054474200,	0.9820543486880550},
    {1,	0,	-1,	1,	-1.8555932062855600,	0.9449747127618360},
    {1,	0,	-1,	1,	-1.8832033391045200,	0.9516362193230460},
    {1,	0,	-1,	1,	-1.8587114365398400,	0.9364595287433200},
    {1,	0,	-1,	1,	-1.8170484243307000,	0.9722317241818310},
    {1,	0,	-1,	1,	-1.8765785694347100,	0.9774246909318430},
    {1,	0,	-1,	1,	-1.7912350639262100,	0.9312851018849480},
    {1,	0,	-1,	1,	-1.8320028571152400,	0.9394253084621390},
    {1,	0,	-1,	1,	-1.7988837311742300,	0.9206439703826680},
    {1,	0,	-1,	1,	-1.7220867236548300,	0.9652730079572110},
    {1,	0,	-1,	1,	-1.8130272671242500,	0.9715911855199390},
    {1,	0,	-1,	1,	-1.6958874120255800,	0.9143901027978460},
    {1,	0,	-1,	1,	-1.7561732434079900,	0.9242012376445640},
    {1,	0,	-1,	1,	-1.7111990996629900,	0.9010813538577700},
    {1,	0,	-1,	1,	-1.5776493960332000,	0.9566888099973400},
    {1,	0,	-1,	1,	-1.7158348894739900,	0.9642235596659710},
    {1,	0,	-1,	1,	-1.5548663293540200,	0.8936709648739570},
    {1,	0,	-1,	1,	-1.6437546496994300,	0.9052379836068940},
    {1,	0,	-1,	1,	-1.5826385082383500,	0.8769825122658350},
    {1,	0,	-1,	1,	-1.3602844366827700,	0.9462039212791820},
    {1,	0,	-1,	1,	-1.5679888049308700,	0.9548778807360830},
    {1,	0,	-1,	1,	-1.3478547892047700,	0.8684867539494270},
    {1,	0,	-1,	1,	-1.4777431497484900,	0.8816205561880300},
    {1,	0,	-1,	1,	-1.3950991843783900,	0.8474400687732100},
    {1,	0,	-1,	1,	-1.0393659207469300,	0.9336052826938810},
    {1,	0,	-1,	1,	-1.3455921735009600,	0.9429282825596680},
    {1,	0,	-1,	1,	-1.2352742754480300,	0.8521586861982150},
    {1,	0,	-1,	1,	-1.0488046565026500,	0.8382699660855850},
    {1,	0,	-1,	1,	-1.1250469169185900,	0.8114313830339230},
    {1,	0,	-1,	1,	-0.5808959176488020,	0.9189042556550430},
    {1,	0,	-1,	1,	-1.0177835329947100,	0.9274214879761310},
    {1,	0,	-1,	1,	-0.8888181175562460,	0.8152039152184890},
    {1,	0,	-1,	1,	-0.6292403393642360,	0.8027504224407340},
    {1,	0,	-1,	1,	-0.7458153508923180,	0.7678306579110570},
    {1,	0,	-1,	1,	0.0379136152808698,	0.9027643595476010},
    {1,	0,	-1,	1,	-0.5515099186972580,	0.9067092486316100},
    {1,	0,	-1,	1,	-0.0699579698262205,	0.7625253167163650},
    {1,	0,	-1,	1,	-0.4132294535315030,	0.7681782453316150},
    {1,	0,	-1,	1,	-0.2367656218569100,	0.7154259580639730},
    {1,	0,	-1,	1,	0.0708002853142735,	0.8772699747262370},
    {1,	0,	-1,	1,	0.7917022440928790,	0.8878741902486560},
    {1,	0,	-1,	1,	0.1930887864008500,	0.7060099760978650},
    {1,	0,	-1,	1,	0.6106759585759470,	0.7209428605779500},
    {1,	0,	-1,	1,	0.3928878273059530,	0.6529388828628160},
    {1,	0,	-1,	1,	1.5385483287931900,	0.8857580586753430},
    {1,	0,	-1,	1,	0.8033922397107510,	0.8279693206011250},
    {1,	0,	-1,	1,	1.3090130451874700,	0.6950274973992850},
    {1,	0,	-1,	1,	0.8546147149533100,	0.6126800655745850},
    {1,	0,	-1,	1,	1.0555793933514100,	0.5790784648244110}};
const double G344[145]={0.0004129135706615370,
    0.0004129135706615370,
    0.0004128283591216850,
    0.0004128283591216850,
    0.0004127958251304920,
    0.0005197396607605650,
    0.0005197396607605650,
    0.0005196046704212380,
    0.0005196046704212380,
    0.0005195531364536330,
    0.0006543304853337490,
    0.0006543304853337490,
    0.0006541165594255360,
    0.0006541165594255360,
    0.0006540349023608410,
    0.0008237280863180250,
    0.0008237280863180250,
    0.0008233891181457930,
    0.0008233891181457930,
    0.0008232597542263560,
    0.0010369629564889500,
    0.0010369629564889500,
    0.0010364259004570200,
    0.0010364259004570200,
    0.0010362209834326100,
    0.0013052642785651700,
    0.0013052642785651700,
    0.0013044135977442700,
    0.0013044135977442700,
    0.0013040891052904000,
    0.0016431224284035800,
    0.0016431224284035800,
    0.0016417748494286900,
    0.0016417748494286900,
    0.0016412609944555000,
    0.0020682804981626000,
    0.0020682804981626000,
    0.0020661462851511000,
    0.0020661462851511000,
    0.0020653328303071500,
    0.0026033578653371400,
    0.0026033578653371400,
    0.0025999784574135300,
    0.0025999784574135300,
    0.0025986911075277200,
    0.0032767536923101400,
    0.0032767536923101400,
    0.0032714037279857900,
    0.0032714037279857900,
    0.0032693671287763800,
    0.0041241068919117000,
    0.0041241068919117000,
    0.0041156398131392200,
    0.0041156398131392200,
    0.0041124194136653800,
    0.0051417335788202500,
    0.0051417335788202500,
    0.0051285866236069400,
    0.0051285866236069400,
    0.0051235914844053800,
    0.0065799151883523300,
    0.0065799151883523300,
    0.0065584177992741800,
    0.0065584177992741800,
    0.0065502619631046400,
    0.0082181755896532700,
    0.0082181755896532700,
    0.0081846988429219800,
    0.0081846988429219800,
    0.0081720194137968500,
    0.0103393271752170000,
    0.0103393271752170000,
    0.0102864579881800000,
    0.0102864579881800000,
    0.0102664767545320000,
    0.0130055285454611000,
    0.0130055285454611000,
    0.0129221124685471000,
    0.0129221124685471000,
    0.0128906713707655000,
    0.0163557595464657000,
    0.0163557595464657000,
    0.0162242984286469000,
    0.0162242984286469000,
    0.0161749149131967000,
    0.0205635083465734000,
    0.0205635083465734000,
    0.0203566277815702000,
    0.0203566277815702000,
    0.0202792384986412000,
    0.0258445252851830000,
    0.0258445252851830000,
    0.0255195572571352000,
    0.0255195572571352000,
    0.0253986268986424000,
    0.0324678421662370000,
    0.0324678421662370000,
    0.0319585406423689000,
    0.0319585406423689000,
    0.0317702356283398000,
    0.0407658529775084000,
    0.0407658529775084000,
    0.0399699483708651000,
    0.0399699483708651000,
    0.0396780148086662000,
    0.0511488074571468000,
    0.0511488074571468000,
    0.0499094754675387000,
    0.0499094754675387000,
    0.0494593230711152000,
    0.0641194431011428000,
    0.0641194431011428000,
    0.0621982754319080000,
    0.0621982754319080000,
    0.0615087438670826000,
    0.0802891480564943000,
    0.0802891480564943000,
    0.0773276548648961000,
    0.0773276548648961000,
    0.0762799656133948000,
    0.1003941135662940000,
    0.1003941135662940000,
    0.0958606561087377000,
    0.0958606561087377000,
    0.0942843084830388000,
    0.1253086846049850000,
    0.1253086846049850000,
    0.1184286644175130000,
    0.1184286644175130000,
    0.1160846710444720000,
    0.1560541027167840000,
    0.1560541027167840000,
    0.1457240669889980000,
    0.1457240669889980000,
    0.1422870209680130000,
    0.1937949711864110000,
    0.1937949711864110000,
    0.1784882665078230000,
    0.1784882665078230000,
    0.1735305585685920000,
    0.2397858195149330000,
    0.2397858195149330000,
    0.2174755009719490000,
    0.2174755009719490000,
    0.2104607675877940000};

//48kHz
const double SOS8[50][6]={
    {1,	0,	-1,	1,	-1.9987785419781900,	0.9988117258019110},
    {1,	0,	-1,	1,	-1.9993777884581000,	0.9993866278646940},
    {1,	0,	-1,	1,	-1.9971209427486900,	0.9971471912629550},
    {1,	0,	-1,	1,	-1.9981283386990000,	0.9981394973411570},
    {1,	0,	-1,	1,	-1.9970705594060100,	0.9970876688734220},
    {1,	0,	-1,	1,	-1.9974984404356400,	0.9976304706427330},
    {1,	0,	-1,	1,	-1.9987413356052400,	0.9987765148787840},
    {1,	0,	-1,	1,	-1.9942115653344000,	0.9943159154709810},
    {1,	0,	-1,	1,	-1.9962467971960800,	0.9962911792808700},
    {1,	0,	-1,	1,	-1.9941294437408600,	0.9941974596068910},
    {1,	0,	-1,	1,	-1.9947529222933400,	0.9952779099207740},
    {1,	0,	-1,	1,	-1.9974203055659500,	0.9975602723081400},
    {1,	0,	-1,	1,	-1.9882767015152000,	0.9886909495382260},
    {1,	0,	-1,	1,	-1.9924370967165000,	0.9926134601020490},
    {1,	0,	-1,	1,	-1.9881856999664500,	0.9884556963352590},
    {1,	0,	-1,	1,	-1.9885166329064000,	0.9906014793303250},
    {1,	0,	-1,	1,	-1.9945811687237500,	0.9951376932542060},
    {1,	0,	-1,	1,	-1.9759231162258900,	0.9775629162306730},
    {1,	0,	-1,	1,	-1.9846155078497700,	0.9853150300291520},
    {1,	0,	-1,	1,	-1.9760282949767200,	0.9770969934941140},
    {1,	0,	-1,	1,	-1.9730865461937500,	0.9813437473671320},
    {1,	0,	-1,	1,	-1.9881093386083600,	0.9903192484068190},
    {1,	0,	-1,	1,	-1.9492801783056100,	0.9557344169724620},
    {1,	0,	-1,	1,	-1.9681407430535500,	0.9709050138662140},
    {1,	0,	-1,	1,	-1.9506053344215500,	0.9548113738628170},
    {1,	0,	-1,	1,	-1.9306827437031400,	0.9631890368913960},
    {1,	0,	-1,	1,	-1.9720058599023600,	0.9807567354123720},
    {1,	0,	-1,	1,	-1.8885318974812400,	0.9136446112809490},
    {1,	0,	-1,	1,	-1.9318797491090600,	0.9427215699124380},
    {1,	0,	-1,	1,	-1.8954079912552000,	0.9117751031393520},
    {1,	0,	-1,	1,	-1.8023071503797200,	0.9284162599148670},
    {1,	0,	-1,	1,	-1.9273789280674200,	0.9618100133290710},
    {1,	0,	-1,	1,	-1.7398199745301200,	0.8352580392918490},
    {1,	0,	-1,	1,	-1.8465966688718200,	0.8884670574336160},
    {1,	0,	-1,	1,	-1.7687708335765300,	0.8310442555528910},
    {1,	0,	-1,	1,	-1.3955531779493600,	0.8661403638647370},
    {1,	0,	-1,	1,	-1.7906838470206800,	0.9239734168407860},
    {1,	0,	-1,	1,	-1.6297666243394900,	0.7861277319901490},
    {1,	0,	-1,	1,	-1.3541257698437400,	0.6994784223963890},
    {1,	0,	-1,	1,	-1.4603554506117600,	0.6867963501848830},
    {1,	0,	-1,	1,	-1.3521878785423800,	0.8435403365885230},
    {1,	0,	-1,	1,	-0.2106576849949040,	0.7793891539872490},
    {1,	0,	-1,	1,	-1.0559839509843300,	0.5924242965235340},
    {1,	0,	-1,	1,	-0.3775767119355060,	0.5026597333620270},
    {1,	0,	-1,	1,	-0.6989267851773300,	0.4454818614031410},
    {1,	0,	-1,	1,	-0.1416568013285740,	0.5913639980916540},
    {1,	0,	-1,	1,	1.8530515046862500,	0.8962482763871150},
    {1,	0,	-1,	1,	1.6583693624895500,	0.7060764017292220},
    {1,	0,	-1,	1,	0.0167934472295311,	0.1536898897912410},
    {1,	0,	-1,	1,	0.8330452984098530,	0.0545720981915791}};
const double G8[50]={0.0014576308112768000,
    0.0014576308112768000,
    0.0014565701059445200,
    0.0014565701059445200,
    0.0014561655632890900,
    0.0029070870276006100,
    0.0029070870276006100,
    0.0029028744365330300,
    0.0029028744365330300,
    0.0029012701965546700,
    0.0057951779898874600,
    0.0057951779898874600,
    0.0057784886447897700,
    0.0057784886447897700,
    0.0057721518323703600,
    0.0115421438898502000,
    0.0115421438898502000,
    0.0114763419562426000,
    0.0114763419562426000,
    0.0114515032529433000,
    0.0229471898007297000,
    0.0229471898007297000,
    0.0226902147212009000,
    0.0226902147212009000,
    0.0225943130685917000,
    0.0454567717030985000,
    0.0454567717030985000,
    0.0444720396725626000,
    0.0444720396725626000,
    0.0441124484303241000,
    0.0893899760313232000,
    0.0893899760313232000,
    0.0857540308589821000,
    0.0857540308589821000,
    0.0844778722235543000,
    0.1732048620122510000,
    0.1732048620122510000,
    0.1607080806469280000,
    0.1607080806469280000,
    0.1566018249075580000,
    0.3260579390159850000,
    0.3260579390159850000,
    0.2885206556669380000,
    0.2885206556669380000,
    0.2772590692984290000,
    0.5838478415853340000,
    0.5838478415853340000,
    0.4969627438920420000,
    0.4969627438920420000,
    0.4727139509042110000};
const double SOS3[150][6]={
    {1,	0,	-1,	1,	-1.9997264944912300,	0.9997399539975210},
    {1,	0,	-1,	1,	-1.9997824399135800,	0.9997911217084900},
    {1,	0,	-1,	1,	-1.9993322079439500,	0.9993445919497050},
    {1,	0,	-1,	1,	-1.9994185486701100,	0.9994279810609780},
    {1,	0,	-1,	1,	-1.9992306550994800,	0.9992414622369400},
    {1,	0,	-1,	1,	-1.9996513442483800,	0.9996726738958890},
    {1,	0,	-1,	1,	-1.9997233230590000,	0.9997370836719440},
    {1,	0,	-1,	1,	-1.9991554461900100,	0.9991750711087530},
    {1,	0,	-1,	1,	-1.9992650739838100,	0.9992800228451220},
    {1,	0,	-1,	1,	-1.9990281543556000,	0.9990452808230110},
    {1,	0,	-1,	1,	-1.9995541035200200,	0.9995879072782290},
    {1,	0,	-1,	1,	-1.9996471923238000,	0.9996690000672450},
    {1,	0,	-1,	1,	-1.9989304139953000,	0.9989615140053650},
    {1,	0,	-1,	1,	-1.9990699389745300,	0.9990936284394850},
    {1,	0,	-1,	1,	-1.9987710071648400,	0.9987981470267080},
    {1,	0,	-1,	1,	-1.9994276487828600,	0.9994812217681580},
    {1,	0,	-1,	1,	-1.9995487437037500,	0.9995833052546770},
    {1,	0,	-1,	1,	-1.9986434865101700,	0.9986927705191140},
    {1,	0,	-1,	1,	-1.9988215141905200,	0.9988590551552440},
    {1,	0,	-1,	1,	-1.9984441517158300,	0.9984871590613170},
    {1,	0,	-1,	1,	-1.9992620254428700,	0.9993469283259860},
    {1,	0,	-1,	1,	-1.9994206576285700,	0.9994754316320690},
    {1,	0,	-1,	1,	-1.9982764506100100,	0.9983545488149340},
    {1,	0,	-1,	1,	-1.9985043263439600,	0.9985638161100480},
    {1,	0,	-1,	1,	-1.9980276342086700,	0.9980957837276860},
    {1,	0,	-1,	1,	-1.9990434138150700,	0.9991779621150800},
    {1,	0,	-1,	1,	-1.9992528835767300,	0.9993396897644380},
    {1,	0,	-1,	1,	-1.9978053375625200,	0.9979290869397640},
    {1,	0,	-1,	1,	-1.9980981297968800,	0.9981923980783720},
    {1,	0,	-1,	1,	-1.9974954996550500,	0.9976034825527070},
    {1,	0,	-1,	1,	-1.9987519625062900,	0.9989651840468540},
    {1,	0,	-1,	1,	-1.9990311954737700,	0.9991687597993980},
    {1,	0,	-1,	1,	-1.9971973940068200,	0.9973934701717560},
    {1,	0,	-1,	1,	-1.9975754425977600,	0.9977248104704290},
    {1,	0,	-1,	1,	-1.9968126944944700,	0.9969837811253700},
    {1,	0,	-1,	1,	-1.9983595499522400,	0.9986974348884340},
    {1,	0,	-1,	1,	-1.9987356455830100,	0.9989536464177300},
    {1,	0,	-1,	1,	-1.9964090614341400,	0.9967197139673730},
    {1,	0,	-1,	1,	-1.9968999010546000,	0.9971365627919800},
    {1,	0,	-1,	1,	-1.9959332680074000,	0.9962043148199830},
    {1,	0,	-1,	1,	-1.9978250583613600,	0.9983604693748050},
    {1,	0,	-1,	1,	-1.9983374421832400,	0.9986828999872260},
    {1,	0,	-1,	1,	-1.9953800335316400,	0.9958721673913700},
    {1,	0,	-1,	1,	-1.9960215555159400,	0.9963964959167210},
    {1,	0,	-1,	1,	-1.9947945348926900,	0.9952238983268560},
    {1,	0,	-1,	1,	-1.9970880432186700,	0.9979364089240250},
    {1,	0,	-1,	1,	-1.9977947267912300,	0.9983421364579700},
    {1,	0,	-1,	1,	-1.9940266186866800,	0.9948061621124250},
    {1,	0,	-1,	1,	-1.9948715887152500,	0.9954655400679240},
    {1,	0,	-1,	1,	-1.9933108853925300,	0.9939909450277590},
    {1,	0,	-1,	1,	-1.9960586732358200,	0.9974028263529810},
    {1,	0,	-1,	1,	-1.9970459175237200,	0.9979132927039260},
    {1,	0,	-1,	1,	-1.9922311734352800,	0.9934657894300700},
    {1,	0,	-1,	1,	-1.9933539756531900,	0.9942947449902860},
    {1,	0,	-1,	1,	-1.9913639615888600,	0.9924409102486520},
    {1,	0,	-1,	1,	-1.9946020441780000,	0.9967315279947200},
    {1,	0,	-1,	1,	-1.9959993752302000,	0.9973736416296750},
    {1,	0,	-1,	1,	-1.9898259972931600,	0.9917809634165870},
    {1,	0,	-1,	1,	-1.9913328401345700,	0.9928226910162430},
    {1,	0,	-1,	1,	-1.9887878364708900,	0.9904929302366080},
    {1,	0,	-1,	1,	-1.9925138582198900,	0.9958870994952390},
    {1,	0,	-1,	1,	-1.9945174158402000,	0.9966945954395660},
    {1,	0,	-1,	1,	-1.9865691112855100,	0.9896639544505980},
    {1,	0,	-1,	1,	-1.9886134945510900,	0.9909723923291470},
    {1,	0,	-1,	1,	-1.9853469886923500,	0.9880458497746440},
    {1,	0,	-1,	1,	-1.9894828452303200,	0.9948253369903920},
    {1,	0,	-1,	1,	-1.9923915887190000,	0.9958403579974620},
    {1,	0,	-1,	1,	-1.9821080029264200,	0.9870057205354970},
    {1,	0,	-1,	1,	-1.9849140815901400,	0.9886479109418950},
    {1,	0,	-1,	1,	-1.9807037257165100,	0.9849739899835830},
    {1,	0,	-1,	1,	-1.9850310074991900,	0.9934904349600730},
    {1,	0,	-1,	1,	-1.9893036012923900,	0.9947656573421950},
    {1,	0,	-1,	1,	-1.9759218049700500,	0.9836693381416900},
    {1,	0,	-1,	1,	-1.9798205783015900,	0.9857285550238160},
    {1,	0,	-1,	1,	-1.9743662788183600,	0.9811197044242660},
    {1,	0,	-1,	1,	-1.9784227150294400,	0.9918132000942400},
    {1,	0,	-1,	1,	-1.9847653463844800,	0.9934139718027460},
    {1,	0,	-1,	1,	-1.9672374999662200,	0.9794861104950950},
    {1,	0,	-1,	1,	-1.9727211987186100,	0.9820648281823210},
    {1,	0,	-1,	1,	-1.9656147605555600,	0.9762887644066490},
    {1,	0,	-1,	1,	-1.9685207904712400,	0.9897069776091510},
    {1,	0,	-1,	1,	-1.9780243383071600,	0.9917140220321750},
    {1,	0,	-1,	1,	-1.9548963572830400,	0.9742464066660690},
    {1,	0,	-1,	1,	-1.9627021657080400,	0.9774699205780660},
    {1,	0,	-1,	1,	-1.9533829427713900,	0.9702398940044390},
    {1,	0,	-1,	1,	-1.9535656439873000,	0.9870642408558780},
    {1,	0,	-1,	1,	-1.9679173316671400,	0.9895762443227140},
    {1,	0,	-1,	1,	-1.9371547547510900,	0.9676924942283710},
    {1,	0,	-1,	1,	-1.9483912412110300,	0.9717119672123600},
    {1,	0,	-1,	1,	-1.9360833488597500,	0.9626762153836830},
    {1,	0,	-1,	1,	-1.9308363160230500,	0.9837525618688450},
    {1,	0,	-1,	1,	-1.9526436580044000,	0.9868881247551670},
    {1,	0,	-1,	1,	-1.9113831755942400,	0.9595103618642820},
    {1,	0,	-1,	1,	-1.9277196120526700,	0.9645043138924040},
    {1,	0,	-1,	1,	-1.9113435698926800,	0.9532351255986630},
    {1,	0,	-1,	1,	-1.8961352884546200,	0.9796092518905440},
    {1,	0,	-1,	1,	-1.9294167319006900,	0.9835073068861270},
    {1,	0,	-1,	1,	-1.8736152637298300,	0.9493188737767600},
    {1,	0,	-1,	1,	-1.8975618186314700,	0.9554915239467910},
    {1,	0,	-1,	1,	-1.8756115225313300,	0.9414742875553860},
    {1,	0,	-1,	1,	-1.8430300562975800,	0.9744383861678370},
    {1,	0,	-1,	1,	-1.8939370315223600,	0.9792537073778600},
    {1,	0,	-1,	1,	-1.8179001623292700,	0.9366649302249880},
    {1,	0,	-1,	1,	-1.8532077847015100,	0.9442359614502860},
    {1,	0,	-1,	1,	-1.8235884055205000,	0.9268620915649870},
    {1,	0,	-1,	1,	-1.7617731301756200,	0.9680081598807500},
    {1,	0,	-1,	1,	-1.8396129210567200,	0.9738969672252340},
    {1,	0,	-1,	1,	-1.7353986542672400,	0.9210187640258240},
    {1,	0,	-1,	1,	-1.7876048065167200,	0.9301969445931770},
    {1,	0,	-1,	1,	-1.7474326665002400,	0.9087640503341040},
    {1,	0,	-1,	1,	-1.6378821524558200,	0.9600548808912040},
    {1,	0,	-1,	1,	-1.7564566189576100,	0.9671385006977560},
    {1,	0,	-1,	1,	-1.6132313185738100,	0.9017816778638660},
    {1,	0,	-1,	1,	-1.6903357722154500,	0.9127048675092270},
    {1,	0,	-1,	1,	-1.6357308332933300,	0.8864338963794800},
    {1,	0,	-1,	1,	-1.4505574092161900,	0.9502996957488870},
    {1,	0,	-1,	1,	-1.6296413227227400,	0.9585818924616550},
    {1,	0,	-1,	1,	-1.4332524697156600,	0.8783136601342260},
    {1,	0,	-1,	1,	-1.5463905058149000,	0.8909215601404510},
    {1,	0,	-1,	1,	-1.4723561100553800,	0.8590078158514100},
    {1,	0,	-1,	1,	-1.1716880606896000,	0.9384948426615820},
    {1,	0,	-1,	1,	-1.4379311542185500,	0.9476794852645180},
    {1,	0,	-1,	1,	-1.1713943376476600,	0.8500033134374660},
    {1,	0,	-1,	1,	-1.3350816679284300,	0.8637721601908350},
    {1,	0,	-1,	1,	-1.2357073042003400,	0.8255046423383980},
    {1,	0,	-1,	1,	-1.1528433809320900,	0.9336242140612560},
    {1,	0,	-1,	1,	-0.7675924791758500,	0.9245395871745480},
    {1,	0,	-1,	1,	-1.0302082376248300,	0.8298094276788910},
    {1,	0,	-1,	1,	-0.7993068167704220,	0.8164313084981850},
    {1,	0,	-1,	1,	-0.8996971074910270,	0.7848348548842910},
    {1,	0,	-1,	1,	-0.2085471503858270,	0.9087749890295920},
    {1,	0,	-1,	1,	-0.7410098091141660,	0.9150938783562730},
    {1,	0,	-1,	1,	-0.2921664071668170,	0.7777657845962450},
    {1,	0,	-1,	1,	-0.6042836817068970,	0.7868883393970710},
    {1,	0,	-1,	1,	-0.4396894520434820,	0.7358156101023690},
    {1,	0,	-1,	1,	-0.1757318528862690,	0.8895112684725800},
    {1,	0,	-1,	1,	0.5040866494922680,	0.8928487999193670},
    {1,	0,	-1,	1,	-0.0431374917282857,	0.7312002991625050},
    {1,	0,	-1,	1,	0.3501937450079630,	0.7359260183375640},
    {1,	0,	-1,	1,	0.1502213346459930,	0.6771918595952250},
    {1,	0,	-1,	1,	0.5292949936386940,	0.8500438959905800},
    {1,	0,	-1,	1,	1.2807500871736500,	0.8832100518796220},
    {1,	0,	-1,	1,	1.0612248808027100,	0.6997364565326180},
    {1,	0,	-1,	1,	0.6160189599204330,	0.6530879670776760},
    {1,	0,	-1,	1,	0.8187863376835580,	0.6076433299006480},
    {1,	0,	-1,	1,	1.2268740800002400,	0.7609702239098310},
    {1,	0,	-1,	1,	1.8780124258609500,	0.9223385936167950},
    {1,	0,	-1,	1,	1.7018415366604400,	0.7588252293283610},
    {1,	0,	-1,	1,	1.1543991866724800,	0.4891260849370190},
    {1,	0,	-1,	1,	1.3925045863861600,	0.5257563926726760}};
const double G3[150]={0.0003793682772628410,
    0.0003793682772628410,
    0.0003792963460218810,
    0.0003792963460218810,
    0.0003792688815297980,
    0.0004775170470058880,
    0.0004775170470058880,
    0.0004774030933796070,
    0.0004774030933796070,
    0.0004773595884943480,
    0.0006011760147351280,
    0.0006011760147351280,
    0.0006009954234409290,
    0.0006009954234409290,
    0.0006009264866462730,
    0.0007568158411280170,
    0.0007568158411280170,
    0.0007565296854471970,
    0.0007565296854471970,
    0.0007564204693416140,
    0.0009527345403472650,
    0.0009527345403472650,
    0.0009522811464521650,
    0.0009522811464521650,
    0.0009521081361569660,
    0.0011992508957153700,
    0.0011992508957153700,
    0.0011985327069807300,
    0.0011985327069807300,
    0.0011982587236464100,
    0.0015096810882681500,
    0.0015096810882681500,
    0.0015085433400404700,
    0.0015085433400404700,
    0.0015081094373151000,
    0.0019003315414671900,
    0.0019003315414671900,
    0.0018985295411413700,
    0.0018985295411413700,
    0.0018978425900085400,
    0.0023919916887468800,
    0.0023919916887468800,
    0.0023891381131272800,
    0.0023891381131272800,
    0.0023880508365718100,
    0.0030107657517060500,
    0.0030107657517060500,
    0.0030062478216210100,
    0.0030062478216210100,
    0.0030045274861206700,
    0.0037894167760709800,
    0.0037894167760709800,
    0.0037822656840270800,
    0.0037822656840270800,
    0.0037795448756739300,
    0.0047691507935983900,
    0.0047691507935983900,
    0.0047578356675874900,
    0.0047578356675874900,
    0.0047535348816962100,
    0.0060017653759984400,
    0.0060017653759984400,
    0.0059838688462349400,
    0.0059838688462349400,
    0.0059770751126778700,
    0.0075520164467041600,
    0.0075520164467041600,
    0.0075237270086581500,
    0.0075237270086581500,
    0.0075130050082082600,
    0.0095017420193490100,
    0.0095017420193490100,
    0.0094570521326987100,
    0.0094570521326987100,
    0.0094401477878672000,
    0.0119527691940424000,
    0.0119527691940424000,
    0.0118822326470415000,
    0.0118822326470415000,
    0.0118556177966753000,
    0.0150331003671568000,
    0.0150331003671568000,
    0.0149218862119261000,
    0.0149218862119261000,
    0.0148800529977807000,
    0.0189026267276066000,
    0.0189026267276066000,
    0.0187275084302824000,
    0.0187275084302824000,
    0.0186618923081584000,
    0.0237603593413056000,
    0.0237603593413056000,
    0.0234850853954573000,
    0.0234850853954573000,
    0.0233824372006684000,
    0.0298547246992513000,
    0.0298547246992513000,
    0.0294229158035501000,
    0.0294229158035501000,
    0.0292628562223072000,
    0.0374930933733565000,
    0.0374930933733565000,
    0.0368175255469993000,
    0.0368175255469993000,
    0.0365689542175064000,
    0.0470555190585004000,
    0.0470555190585004000,
    0.0460020775039073000,
    0.0460020775039073000,
    0.0456179748329483000,
    0.0590088392353889000,
    0.0590088392353889000,
    0.0573729411630312000,
    0.0573729411630312000,
    0.0567830518102601000,
    0.0739225401997950000,
    0.0739225401997950000,
    0.0713952241430816000,
    0.0713952241430816000,
    0.0704960920742949000,
    0.0924851387431417000,
    0.0924851387431417000,
    0.0886056923573992000,
    0.0886056923573992000,
    0.0872476788308011000,
    0.1155187251210530000,
    0.1155187251210530000,
    0.1096111754373940000,
    0.1096111754373940000,
    0.1075825725578550000,
    0.1439902349514900000,
    0.1439902349514900000,
    0.1350829474678870000,
    0.1350829474678870000,
    0.1320921949488150000,
    0.1790124994295030000,
    0.1790124994295030000,
    0.1657454615848860000,
    0.1657454615848860000,
    0.1614040702023880000,
    0.2218334279138090000,
    0.2218334279138090000,
    0.2023675996295870000,
    0.2023675996295870000,
    0.1961783350496760000,
    0.2738029979672370000,
    0.2738029979672370000,
    0.2457644069853140000,
    0.2457644069853140000,
    0.2371218036636620000};

//==============================================================================
BicuadFilter::BicuadFilter(): u1(0), u2(0), active(false){
}

BicuadFilter::~BicuadFilter(){
}

//==============================================================================
void BicuadFilter::makeInactive(){
    active = false;
}

//==============================================================================
void BicuadFilter::setCoeficientes (const double* _coeff,const double* G){
    const double aux1=*G/_coeff[3];
    const double aux2=1.0/_coeff[3];
    
    coeff[0]=_coeff[0]*aux1;
    coeff[1]=_coeff[1]*aux1;
    coeff[2]=_coeff[2]*aux1;
    coeff[3]=_coeff[4]*aux2;
    coeff[4]=_coeff[5]*aux2;
    
    active = true;
}

//==============================================================================
void BicuadFilter::reset(){
    u1 = u2 = 0;
}

//==============================================================================
void BicuadFilter::processSamples (float* const samples, const int numSamples){    
    if (active){
        const float b0 = coeff[0];
        const float b1 = coeff[1];
        const float b2 = coeff[2];
        const float a1 = coeff[3];
        const float a2 = coeff[4];
        float u_1 = u1, u_2 = u2;
        
        for (int i = 0; i < numSamples; i++){
            const float in = samples[i];
            const float out = b0*in + u_1;
            samples[i] = out;
            
            u_1 = b1*in - a1*out + u_2;
            u_2 = b2*in - a2*out;
        }
        u1 = u_1;
        u2 = u_2;
    }
}

/*
 ==============================================================================
 BandFilter Class
 ==============================================================================
*/
BandFilter::BandFilter(int bandFilterOrder){
    for(int i=0;i<bandFilterOrder/2;i++){
        bicuadFiltersArray.add(new BicuadFilter());
    }
}

BandFilter::~BandFilter(){
}

void BandFilter::reset(){
    for(int i=0;i<bicuadFiltersArray.size();i++){
        bicuadFiltersArray[i]->reset();
    }
}

void BandFilter::processSamples (float* const samples, const int numSamples){
    for(int i=0;i<bicuadFiltersArray.size();i++){
        bicuadFiltersArray[i]->processSamples(samples, numSamples);
    }
}

/*
 ==============================================================================
 FilterBank Class
 ==============================================================================
*/
FilterBank::FilterBank(int _freqRes, double _Fs){
    Fs = _Fs;
    freqRes=_freqRes;
    bandFilterOrder = 10;

    if(freqRes==1){     
        if(Fs==44100) numeroBandas=9;
        else if (Fs==48000) numeroBandas=10;
    }else if (freqRes==2){
        if(Fs==44100) numeroBandas=29;
        else if (Fs==48000) numeroBandas=30;
    }
    
    for(int i=0;i<numeroBandas;i++){
        bandFiltersArray.add(new BandFilter(bandFilterOrder));
    }
}

FilterBank::~FilterBank(){
}

void FilterBank::processSamples(float* const input,OwnedArray<Buffer>* outputs,int numSamples){
    for(int i=0; i<bandFiltersArray.size(); i++){
        memcpy(outputs->getUnchecked(i)->getData(), input, numSamples*sizeof(float));
        bandFiltersArray[i]->processSamples(outputs->getUnchecked(i)->getData(), numSamples);
    }
}

void FilterBank::setCoeficientes(){
    const double* G;
    if (numeroBandas==9) G=G844;
    else if (numeroBandas==10) G=G8;
    else if (numeroBandas==29) G=G344;
    else if (numeroBandas==30) G=G3;

    
    for(int i=0; i<bandFiltersArray.size(); i++){
        for(int j=0; j<bandFilterOrder/2; j++){
            const double* coeff;
            if (numeroBandas==9) coeff= SOS844[5*i+j];
            else if (numeroBandas==10) coeff= SOS8[5*i+j];
            else if (numeroBandas==29) coeff= SOS344[5*i+j];
            else if (numeroBandas==30) coeff= SOS3[5*i+j];

            bandFiltersArray[i]->bicuadFiltersArray[j]->setCoeficientes(coeff, G);
            G++;
        }
    }
}
